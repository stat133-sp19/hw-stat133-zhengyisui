"0","set.seed(154)"
"0","total_data2$xbins <- cut_number(total_data2$x, xs, labels = seq(1:xs))"
"0","total_data2$ybins <- cut_number(total_data2$y, ys, labels = seq(1:ys))"
"0","total_data2$blocks <- as.numeric(factor(paste0(total_data2$xbins, total_data2$ybins)))"
"0","# there may be some blocks without any labeled data"
"0","blocks <- length(unique(total_data2$blocks))"
"0","test_idx2 <- sample(seq(1:blocks), test_size * blocks)"
"0","test_set2 <- total_data2[total_data2$blocks %in% test_idx2, ]"
"0","train_set2 <- total_data2[total_data2$blocks %notin% test_idx2, ]"
"0","#further splitting trainset into training and validation set."
"0","train_len2 <- length(unique(train_set2$blocks))"
"0","val_idx2 <- sample(seq(1:train_len2), val_size * train_len2)"
"0","val_set2 <- train_set2[train_set2$blocks %in% val_idx2, ]"
"0","train_set2 <- train_set2[train_set2$blocks %notin% val_idx2, ]"
"0","hist(total_data2$blocks)"
